location / {
    add_header       X-Served-By $host;
    proxy_set_header X-Forwarded-Proto $scheme; 
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_pass       $forward_scheme://$server:$port$request_uri;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";

    # 隐藏 Nextcloud 发送的 CSP 头
    proxy_hide_header Content-Security-Policy;

    # 添加一个新的 CSP 头，这里使用 * 作为通配符，但请注意安全风险
    add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; frame-src 'self'; img-src 'self' data:; font-src 'self' data:; connect-src 'self'; media-src 'self'; object-src 'none'; form-action 'self' *; base-uri 'self';" always;
}
