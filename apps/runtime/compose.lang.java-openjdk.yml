x-java-defaults: &java_defaults
  restart: always
  entrypoint: bash -c "cat /opt/config/java/service.sh > /cmd.sh && chmod +x /cmd.sh && /cmd.sh"
  working_dir: /data/apps
  volumes: 
      - ./config/java:/opt/config/java
  environment:
      - JAVA_APP=${JAVA_APP}
      
services:

  java17:
    container_name: java17
    build:
      context: src
      dockerfile: Dockerfile.java
      args:
        - JDK_VERSION=17
    volumes: 
      - java17:/data/apps
    <<: *java_defaults

volumes:
  java17:

networks:
  default:
    name: ${APP_NETWORK}
    external: true
